/*!

Name: Vimy
Dependencies: jQuery
Author: Michael Lynch
Author URL: http://michaelynch.com
Date Created: June 19, 2014
Last Updated: June 19, 2014
Licensed under the MIT license

*/
;(function(e){e.fn.vimy=function(t){function o(e){var t="<li>";if(i.title){t+='<h2 class="vimy-title">'+e.title;if(i.duration){var n=Math.floor(e.duration/60);var r=Math.round(e.duration%60);r=r.toString();if(r.length<2){r="0"+r}var s=n+":"+r;t+=" <span>("+s+")</span>"}t+="</h2>"}if(i.date&&e.date!==""){var o=new Date(e.date.replace(/-/g,"/"));var u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var a=["January","February","March","April","May","June","July","August","September","October","November","December"];var f=o.getDay();var l=o.getMonth();o=u[f]+" "+a[l]+" "+o.getDate()+", "+o.getFullYear();t+='<div class="vimy-date">'+o+"</div>"}t+='<iframe src="//player.vimeo.com/video/'+e.id+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>';if(i.description&&e.description!==""){t+="<p>"+e.description.replace(/(<([^>]+)>)/ig,"")+"</p>"}if(i.tags&&e.tags!==""){t+='<ul class="vimy-tags">';var c=e.tags.split(", ");for(var h=0;h<c.length;h++){var p='<li><a href="http://vimeo.com/search?q='+c[h]+'" target="_blank">'+c[h]+"</a></li>";t+=p}t+="</ul>"}t+="</li>";return t}function u(e){var t;t='<li data-id="'+e.id+'" data-title="'+e.title+'" data-duration="'+e.duration+'" data-date="'+e.date+'"';if(e.description!==""){t+=' data-description="'+e.description.replace(/(<([^>]+)>)/ig,"")+'"'}if(e.tags!==""){t+=' data-tags="'+e.tags+'"'}if(i.imgFormat==="element"){t+='><img src="'+e.img+'" alt="'+e.title+'" /></li>'}else{t+=' style="background: url('+e.img+') center center; background-size: cover;"></li>'}return t}if(!this.length){return this}var n={username:"brad",gallery:false,imgFormat:"bg",limit:9,title:true,duration:true,date:true,description:true,tags:true,error:function(e){},success:function(){}};var r=this;r.settings={};r.settings=e.extend({},n,t);var i=r.settings;var s=e(this);s.each(function(){var t=e(this);e.ajax({method:"GET",url:"http://vimeo.com/api/v2/"+i.username+"/videos.json",success:function(e){var n=e.length<i.limit?e.length:i.limit;for(var a=0;a<n;a++){if(e[a].embed_privacy==="anywhere"){if(i.gallery===true){if(a===0){firstVideo=o({id:e[a].id,title:e[a].title,duration:e[a].duration,date:e[a].upload_date,description:e[a].description,tags:e[a].tags});t.append(firstVideo)}video=u({id:e[a].id,title:e[a].title,duration:e[a].duration,date:e[a].upload_date,description:e[a].description,tags:e[a].tags,img:e[a].thumbnail_large,index:i.limit})}else{video=o({id:e[a].id,title:e[a].title,duration:e[a].duration,date:e[a].upload_date,description:e[a].description,tags:e[a].tags})}t.append(video)}else{i.limit++}}s.children().eq(1).addClass("active");r.settings.success.call(this)},error:function(){}})});if(i.gallery===true){s.addClass("gallery");s.on("click",".vimy-tags a",function(e){e.stopPropagation()});s.on("click","li",function(t){t.preventDefault();e(this).addClass("active").siblings().removeClass("active");video=o({id:e(this).attr("data-id"),title:e(this).attr("data-title"),duration:e(this).attr("data-duration"),date:e(this).attr("data-date"),description:e(this).attr("data-description")?e(this).attr("data-description"):"",tags:e(this).attr("data-tags")?e(this).attr("data-tags"):""});s.children("li").eq(0).remove();s.prepend(video)})}}})(jQuery)